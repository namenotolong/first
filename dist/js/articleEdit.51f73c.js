(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{640:function(e,t,i){},641:function(e,t,i){},642:function(e,t,i){},775:function(e,t,i){"use strict";var a=i(640);i.n(a).a},776:function(e,t,i){"use strict";var a=i(641);i.n(a).a},777:function(e,t,i){"use strict";var a=i(642);i.n(a).a},868:function(e,t,i){"use strict";i.r(t);var a=i(122),n=i.n(a),l=i(182),r=i.n(l),s=i(13),o=i.n(s),c=i(77),u=i(712),d=i(183),m=i(708),p={props:{value:{type:Array,default:function(){return[]}},action:{required:!0,type:String,default:""},name:{type:String,default:"file"},sizeLimit:{type:Number,default:10},tip:{type:String,default:""}},data:function(){return{loading:!1}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<this.sizeLimit;return t||this.$message.error("上传的文件小不能超过 "+this.sizeLimit+"MB!"),t&&(this.loading=!0),t},beforeRemove:function(e,t){return this.$confirm("确定删除“"+e.name+"”？")},handleSuccess:function(e,t,i){this.loading=!1,this.$emit("input",i)},handleRemove:function(e,t){this.$emit("input",t)},handlePreview:function(e){window.open(e.url)}}},f=(i(775),i(776),i(50)),h=Object(f.a)(p,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-upload",{staticClass:"drag-upload",attrs:{action:e.action,name:e.name,drag:"",multiple:"","file-list":e.value,"before-upload":e.beforeUpload,"before-remove":e.beforeRemove,"on-success":e.handleSuccess,"on-remove":e.handleRemove,"on-preview":e.handlePreview}},[i("i",{staticClass:"drag-upload__icon",class:e.loading?"el-icon-loading":"el-icon-upload "}),e._v(" "),i("p",{staticClass:"drag-upload__text"},[e._v("点击或直接将文件拖到此处上传")]),e._v(" "),i("p",{staticClass:"drag-upload__tip"},[e._v("文件大小不能超过"+e._s(e.sizeLimit)+"MB！"+e._s(e.tip))])])],1)},[],!1,null,"33627e54",null).exports,g=i(610),b=i(35),v={props:{id:{type:String,default:function(){return"tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},height:{type:Number,default:500}},data:function(){return{hasInit:!1,hasInput:!1}},watch:{value:function(e){!this.hasInput&&this.hasInit&&tinymce.get(this.id).insertContent(e)}},mounted:function(){this.init()},destroyed:function(){this.destoryTinymce()},activated:function(){this.init()},deactivated:function(){this.destoryTinymce()},methods:{init:function(){var e=this;Object(b.c)("https://cdn.jsdelivr.net/npm/tinymce@5.1.2/tinymce.min.js",function(t,i){t?e.$message.error(t.message):e.initTinymce()})},initTinymce:function(){var e=this;tinymce.init({selector:"#"+this.id,language:"zh_CN",language_url:"/static/tinymce/langs/zh_CN.js",height:this.height,plugins:"advlist autosave autolink charmap code codesample emoticons fullscreen help hr image insertdatetime link lists media pagebreak paste preview print searchreplace table textpattern visualblocks visualchars wordcount",toolbar:"restoredraft | undo redo | styleselect | bold italic underline forecolor backcolor removeformat | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | table link image media emoticons charmap | searchreplace fullscreen preview code print",contextmenu:"copy paste link inserttable ",auto_focus:this.id,paste_enable_default_filters:!1,insertdatetime_formats:["%Y-%m-%d %H:%M:%S","%Y/%m/%d %H:%M:%S","%Y年%m月%d日 %H点%M分%S秒","%Y年%m月%d日","%H点%M分"],table_toolbar:"tableprops tablerowprops tablecellprops | tableinsertcolbefore tableinsertcolafter tabledeletecol | tableinsertrowbefore tableinsertrowafter tabledeleterow | tablemergecells tablesplitcells | tabledelete",link_context_toolbar:!0,link_assume_external_targets:!0,setup:function(e){},init_instance_callback:function(t){e.hasInit=!0,e.value&&t.insertContent(e.value),t.on("setContent keyup",function(){e.hasInput=!0,e.$emit("input",t.getContent())})},images_upload_handler:function(e,t,i){var a=e.blob(),n=e.base64(),l=a.type;"image/jpeg"===l?n="data:image/jpeg;base64,"+n:"image/png"===l?n="data:image/png;base64,"+n:"image/gif"===l&&(n="data:image/gif;base64,"+n);var r=new FormData;r.append("file",a),r.append("name",a.name),t(n)}})},destoryTinymce:function(){tinymce.get(this.id)&&tinymce.get(this.id).destroy()}}},_=Object(f.a)(v,function(){var e=this.$createElement;return(this._self._c||e)("textarea",{directives:[{name:"loading",rawName:"v-loading",value:!this.hasInit,expression:"!hasInit"}],staticStyle:{visibility:"hidden"},attrs:{id:this.id}})},[],!1,null,null,null).exports,y={id:"",name:"",type:"",content:""},w={name:"ArticleEdit",props:["articleId"],components:{AvatarUpload:m.a,DragUpload:h,SectionTitle:g.a,Tinymce:_},data:function(){return{tableMng:d.a,articleDetail:o()({},y),formRules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"},{max:20,message:"标题不能超过20个字",trigger:"blur"}]},submitLoading:!1}},created:function(){this.getDetail()},methods:{getDetail:function(){var e=this;return r()(n.a.mark(function t(){var i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.articleId){t.next=7;break}return t.next=3,c.a.article.getDetail({id:e.articleId});case 3:i=t.sent,e.articleDetail={id:i.id,title:i.title,content:i.content},t.next=8;break;case 7:e.articleDetail=o()({},y);case 8:case"end":return t.stop()}},t,e)}))()},handleSubmit:function(){var e,t=this;this.$refs.form.validate((e=r()(n.a.mark(function e(i){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=11;break}return t.submitLoading=!0,t.articleDetail.type=1,t.articleId?t.articleDetail.ops=1:t.articleDetail.ops=0,e.next=6,c.a.article.update(t.articleDetail);case 6:t.submitLoading=!1,t.$message.success("发布成功"),t.handleClose(),e.next=12;break;case 11:t.$message.error("请按照正确格式填写");case 12:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleClose:function(){u.a.$emit("closeTag",this.$route.path),this.$router.push("/article/list")}}},k=(i(777),Object(f.a)(w,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"article-edit"},[i("div",{staticClass:"article-edit__header"},[i("div",{staticClass:"title"},[i("section-title",{attrs:{name:e.articleId?"编辑文章":"新增文章"}})],1),e._v(" "),i("div",{staticClass:"operation"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-s-promotion",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("发布")]),e._v(" "),i("el-button",{attrs:{type:"info",icon:"el-icon-circle-close"},on:{click:e.handleClose}},[e._v("取消")])],1)]),e._v(" "),i("el-row",[i("el-col",{attrs:{lg:16}},[i("tinymce",{attrs:{height:660},model:{value:e.articleDetail.content,callback:function(t){e.$set(e.articleDetail,"content",t)},expression:"articleDetail.content"}})],1),e._v(" "),i("el-col",{attrs:{lg:8}},[i("el-form",{ref:"form",staticClass:"article-edit__form",attrs:{model:e.articleDetail,rules:e.formRules,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.articleDetail.title,callback:function(t){e.$set(e.articleDetail,"title",t)},expression:"articleDetail.title"}})],1)],1)],1)],1)],1)},[],!1,null,"105c2074",null).exports);i.d(t,"default",function(){return k})}}]);