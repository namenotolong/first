(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{700:function(e,t,n){},701:function(e,t,n){},702:function(e,t,n){},703:function(e,t,n){},704:function(e,t,n){},705:function(e,t,n){},706:function(e,t,n){},850:function(e,t,n){"use strict";var a=n(700);n.n(a).a},851:function(e,t,n){"use strict";var a=n(701);n.n(a).a},852:function(e,t,n){"use strict";var a=n(702);n.n(a).a},853:function(e,t,n){"use strict";var a=n(703);n.n(a).a},854:function(e,t,n){"use strict";var a=n(704);n.n(a).a},855:function(e,t,n){"use strict";var a=n(705);n.n(a).a},856:function(e,t,n){"use strict";var a=n(706);n.n(a).a},872:function(e,t,n){"use strict";n.r(t);var a=n(122),r=n.n(a),i=n(182),o=n.n(i),l=n(77),s=n(35),c=n(183),u=n(610),d=n(613),p=n(612),m=n(13),f=n.n(m),b=n(708),g=n(709),v={id:"",userName:"",email:"",school:"",work:"",age:"",address:"",role:"",gender:"",picture:"",password:"",sex:""},h={props:{id:{type:String,default:""},visible:{type:Boolean,default:!1}},components:{AvatarUpload:b.a},watch:{visible:function(e){e&&this.getDetail()}},data:function(){var e=this;return{baseUrl:"http://zhsdsb.top:8081",tableMng:c.a,params:{},passwordType:"password",userInfoBackup:f()({},v),userInfo:f()({},v),formRules:{userName:[{validator:function(t,n,a){""===n?a(new Error("请输入用户名")):/^\w+((.\w+)|(-\w+))@[A-Za-z0-9]+((.|-)[A-Za-z0-9]+).[A-Za-z0-9]+$/.test(n)?a(new Error("用户名不能是邮箱格式")):e.id?a():e.checkAccountUnique(n,1).then(function(e){e?a():a("该用户名已被注册")})},trigger:"blur",required:!0}],role:[{required:!0,message:"请选择角色",trigger:"change"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],email:[{validator:function(t,n,a){""===n?a(new Error("请输入邮箱")):/^\w+((.\w+)|(-\w+))@[A-Za-z0-9]+((.|-)[A-Za-z0-9]+).[A-Za-z0-9]+$/.test(n)?e.id?a():e.checkAccountUnique(n,0).then(function(e){e?a():a("该邮箱已被注册")}):a(new Error("邮箱格式不正确"))},trigger:"blur",required:!0}]},submitLoading:!1,getDetailLoading:!1}},methods:{updateImg:function(e){this.userInfo.picture=e},showPwd:function(){this.passwordType="password"==this.passwordType?"text":"password"},checkAccountUnique:function(e,t){var n=this;return o()(r.a.mark(function a(){var i;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(i={}).account=e,i.ops=t,n.next=5,l.a.user.unique(i);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},a,n)}))()},getDetail:function(){var e=this;return o()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.id){t.next=2;break}return t.abrupt("return");case 2:return e.getDetailLoading=!0,t.next=5,l.a.user.getDetail({id:e.id});case 5:n=t.sent,e.userInfo=f()({},n),e.userInfo.role=c.a.getNameById("role",e.userInfo.role),e.userInfo.password=Object(g.a)(e.userInfo.password),e.userInfoBackup=f()({},n),e.getDetailLoading=!1;case 11:case"end":return t.stop()}},t,e)}))()},handleSubmit:function(){var e,t=this;this.$refs.form.validate((e=o()(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=14;break}return t.submitLoading=!0,t.id?t.userInfo.ops=1:t.userInfo.ops=0,t.userInfo.role=c.a.getIdByName("role",t.userInfo.role),t.userInfo.sex=c.a.getNameById("gender",t.userInfo.gender),t.userInfo.password=Object(g.b)(t.userInfo.password),e.next=8,l.a.user.update(t.userInfo);case 8:t.submitLoading=!1,t.handleClose(),t.$emit("onSave"),t.$message.success("提交成功"),e.next=15;break;case 14:t.$message.error("请按照正确格式填写");case 15:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleBeforeClose:function(){var e=this;window.JSON.stringify(this.userInfoBackup)===window.JSON.stringify(this.userInfo)?this.handleClose():this.$confirm("信息修改后未提交，确认关闭？","提示",{type:"warning"}).then(function(){e.handleClose()}).catch(function(){})},handleClose:function(){this.$refs.form.resetFields(),this.userInfo=v,this.userInfoBackup=v,this.$emit("onClose")}}},_=(n(850),n(50)),w=Object(_.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"user-edit",attrs:{title:e.id?"编辑用户":"新增用户",width:"700px",visible:e.visible,"before-close":e.handleBeforeClose}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.getDetailLoading,expression:"getDetailLoading"}],ref:"form",attrs:{model:e.userInfo,rules:e.formRules,"label-width":"70px"}},[n("el-form-item",{attrs:{label:"昵称:",prop:"userName"}},[n("el-input",{attrs:{placeholder:"请填写昵称",clearable:""},model:{value:e.userInfo.userName,callback:function(t){e.$set(e.userInfo,"userName",t)},expression:"userInfo.userName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"邮箱:",prop:"email"}},[n("el-input",{attrs:{placeholder:"请填写邮箱",clearable:""},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码:",prop:"password"}},[n("el-input",{attrs:{placeholder:"请填写密码",clearable:"",type:e.passwordType},model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}},[n("svg-icon",{attrs:{slot:"prefix","icon-name":"password","icon-class":"icon"},slot:"prefix"}),e._v(" "),n("svg-icon",{attrs:{slot:"suffix","icon-name":"eye","icon-class":"icon icon-eye"},nativeOn:{click:function(t){return e.showPwd(t)}},slot:"suffix"})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"角色:",prop:"role"}},[n("el-select",{attrs:{placeholder:"请选择用户角色"},model:{value:e.userInfo.role,callback:function(t){e.$set(e.userInfo,"role",t)},expression:"userInfo.role"}},e._l(e.tableMng.getTable("role"),function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[n("el-radio-group",{model:{value:e.userInfo.gender,callback:function(t){e.$set(e.userInfo,"gender",t)},expression:"userInfo.gender"}},[n("el-radio",{attrs:{label:0}},[e._v("男")]),e._v(" "),n("el-radio",{attrs:{label:1}},[e._v("女")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"头像:"}},[n("avatar-upload",{attrs:{params:e.params,baseUrl:e.baseUrl,action:e.baseUrl+"/file/uploadImg",name:"file"},on:{"update-img":e.updateImg},model:{value:e.baseUrl+e.userInfo.picture,callback:function(t){e.$set(e.baseUrl+e.userInfo,"picture",t)},expression:"baseUrl + userInfo.picture"}})],1),e._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"学校:",placeholder:"请填写学校",prop:"school"}},[n("el-input",{attrs:{clearable:""},model:{value:e.userInfo.school,callback:function(t){e.$set(e.userInfo,"school",t)},expression:"userInfo.school"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"工作:",placeholder:"请填写工作",prop:"work"}},[n("el-input",{attrs:{clearable:""},model:{value:e.userInfo.work,callback:function(t){e.$set(e.userInfo,"work",t)},expression:"userInfo.work"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"年龄:",placeholder:"请填写年龄",prop:"age"}},[n("el-input",{attrs:{type:"number",clearable:""},model:{value:e.userInfo.age,callback:function(t){e.$set(e.userInfo,"age",t)},expression:"userInfo.age"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"地址:",placeholder:"请填写地址",prop:"address"}},[n("el-input",{attrs:{clearable:""},model:{value:e.userInfo.address,callback:function(t){e.$set(e.userInfo,"address",t)},expression:"userInfo.address"}})],1)],1)],1)],1),e._v(" "),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("提 交")])],1)],1)},[],!1,null,"d1761ab4",null).exports,y={name:"User",components:{SectionTitle:u.a,ExportExcel:d.a,Pagination:p.a,Edit:w},data:function(){return{tableMng:c.a,userList:[],tableLoading:!1,queryCondition:{name:"",gender:"",roles:[],pageNumber:1,pageSize:20,school:"",email:"",online:""},total:0,selectedRows:[],editId:"",editVisible:!1}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return o()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,l.a.user.getList(e.queryCondition);case 3:n=t.sent,e.userList=n.list.map(function(t,n){return{id:t.id,index:(e.queryCondition.pageNumber-1)*e.queryCondition.pageSize+n+1,name:t.userName,email:t.email,gender:t.gender,work:t.work,online:t.online,address:t.address,school:t.school,picture:t.picture,age:t.age,role:t.role,createDate:e.$dayjs(t.createDate).format("YYYY-MM-DD HH:mm:ss")}}),e.total=n.total,e.tableLoading=!1,a=document.querySelector(".inner-layout__page"),Object(s.e)(a,0,800);case 9:case"end":return t.stop()}},t,e)}))()},handleEdit:function(e,t){this.editId=t?t.id+"":"",this.editVisible=!0},handleDelete:function(e,t){var n=this,a=[],i=[];t?(a=[t.id],i=[t.name]):(a=this.selectedRows.map(function(e){return e.id}),i=this.selectedRows.map(function(e){return e.name})),0===i.length?this.$message.warning("请选择要删除的用户！"):this.$confirm("确定删除用户：“"+i.join("，")+"”？","提示",{type:"warning"}).then(o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.user.remove({id:a});case 2:n.$message.success("删除成功！"),n.getUserList();case 4:case"end":return e.stop()}},e,n)}))).catch(function(){})},handleSelectedRows:function(e){this.selectedRows=e},handleSave:function(){this.handleClose(),this.getUserList()},handleClose:function(){this.editVisible=!1}}},x=(n(851),Object(_.a)(y,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-manager"},[n("div",{staticClass:"user-manager__header"},[n("div",{staticClass:"title"},[n("section-title",{attrs:{name:"用户列表"}})],1),e._v(" "),n("div",{staticClass:"operation"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleEdit}},[e._v("新增用户")]),e._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-minus"},on:{click:e.handleDelete}},[e._v("批量删除")]),e._v(" "),n("export-excel",{attrs:{"file-name":"用户数据表",header:["序号","姓名","邮箱","学校","年龄","状态","性别","角色","注册时间"],"filter-filed":["index","name","email","school","age","online","gender","role","createDate"],data:e.userList}},[e._v("\n        导出表格\n      ")])],1)]),e._v(" "),n("el-form",{attrs:{inline:!0,model:e.queryCondition}},[n("el-form-item",{attrs:{label:"昵称:"}},[n("el-input",{attrs:{placeholder:"请输入昵称关键字",clearable:""},model:{value:e.queryCondition.name,callback:function(t){e.$set(e.queryCondition,"name",t)},expression:"queryCondition.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"学校:"}},[n("el-input",{attrs:{placeholder:"请输入学校关键字",clearable:""},model:{value:e.queryCondition.school,callback:function(t){e.$set(e.queryCondition,"school",t)},expression:"queryCondition.school"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"邮箱:"}},[n("el-input",{attrs:{placeholder:"请输入邮箱关键字",clearable:""},model:{value:e.queryCondition.email,callback:function(t){e.$set(e.queryCondition,"email",t)},expression:"queryCondition.email"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"性别:"}},[n("el-select",{attrs:{placeholder:"请选择性别",clearable:""},model:{value:e.queryCondition.gender,callback:function(t){e.$set(e.queryCondition,"gender",t)},expression:"queryCondition.gender"}},e._l(e.tableMng.getTable("gender"),function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"角色:"}},[n("el-select",{attrs:{placeholder:"请选择角色",multiple:"",clearable:""},model:{value:e.queryCondition.roles,callback:function(t){e.$set(e.queryCondition,"roles",t)},expression:"queryCondition.roles"}},e._l(e.tableMng.getTable("role"),function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"在线:"}},[n("el-select",{attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.queryCondition.online,callback:function(t){e.$set(e.queryCondition,"online",t)},expression:"queryCondition.online"}},e._l(e.tableMng.getTable("online"),function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getUserList}},[e._v("查询")])],1)],1),e._v(" "),n("div",{staticClass:"user-manager__table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.userList,border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectedRows}},[n("el-table-column",{attrs:{type:"selection",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"序号",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"school",label:"学校",width:"120px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"age",label:"年龄",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"online",label:"状态",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.tableMng.getNameById("online",t.row.online)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"gender",label:"性别",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.tableMng.getNameById("gender",t.row.gender)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"role",label:"角色",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.tableMng.getNameById("role",t.row.role)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"createDate",label:"注册时间",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),n("pagination",{attrs:{total:e.total,"page-number":e.queryCondition.pageNumber,"page-size":e.queryCondition.pageSize},on:{"update:pageNumber":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:page-number":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:pageSize":function(t){return e.$set(e.queryCondition,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryCondition,"pageSize",t)},pagination:e.getUserList}}),e._v(" "),n("edit",{attrs:{id:e.editId,visible:e.editVisible},on:{onClose:e.handleClose,onSave:e.handleSave}})],1)},[],!1,null,"0a360bf2",null).exports);n.d(t,"default",function(){return x})},875:function(e,t,n){"use strict";n.r(t);var a=n(122),r=n.n(a),i=n(182),o=n.n(i),l=n(77),s=n(35),c=n(183),u=n(610),d=n(613),p=n(612),m=n(13),f=n.n(m),b={content:"",createTime:""},g={props:{id:{type:String,default:""},visible:{type:Boolean,default:!1}},data:function(){return{params:{},userInfoBackup:f()({},b),userInfo:f()({},b),formRules:{content:[{required:!0,message:"请输入内容",trigger:"blur"}],createTime:[{required:!0,message:"请选择时间",trigger:"blur"}]},submitLoading:!1,getDetailLoading:!1}},methods:{handleSubmit:function(){var e,t=this;this.$refs.form.validate((e=o()(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}return t.submitLoading=!0,e.next=4,l.a.message.update(t.userInfo);case 4:t.submitLoading=!1,t.handleClose(),t.$emit("onSave"),t.$message.success("提交成功"),e.next=11;break;case 10:t.$message.error("请按照正确格式填写");case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleBeforeClose:function(){var e=this;window.JSON.stringify(this.userInfoBackup)===window.JSON.stringify(this.userInfo)?this.handleClose():this.$confirm("信息修改后未提交，确认关闭？","提示",{type:"warning"}).then(function(){e.handleClose()}).catch(function(){})},handleClose:function(){this.$refs.form.resetFields(),this.userInfo=b,this.userInfoBackup=b,this.$emit("onClose")}}},v=(n(852),n(50)),h=Object(v.a)(g,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"user-edit",attrs:{title:e.id?"编辑消息":"新增系统消息",width:"700px",visible:e.visible,"before-close":e.handleBeforeClose}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.getDetailLoading,expression:"getDetailLoading"}],ref:"form",attrs:{model:e.userInfo,rules:e.formRules,"label-width":"70px"}},[n("el-form-item",{attrs:{label:"内容:",prop:"content"}},[n("el-input",{attrs:{placeholder:"请填写昵称",clearable:""},model:{value:e.userInfo.content,callback:function(t){e.$set(e.userInfo,"content",t)},expression:"userInfo.content"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"时间:",prop:"createTime"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.userInfo.createTime,callback:function(t){e.$set(e.userInfo,"createTime",t)},expression:"userInfo.createTime"}})],1)],1),e._v(" "),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("提 交")])],1)],1)},[],!1,null,"20487af6",null).exports,_={name:"User",components:{SectionTitle:u.a,ExportExcel:d.a,Pagination:p.a,Edit:h},data:function(){return{tableMng:c.a,messageList:[],tableLoading:!1,queryCondition:{from:"",to:"",types:[],pageNumber:1,pageSize:20,content:"",title:"",common:""},total:0,selectedRows:[],editId:"",editVisible:!1}},created:function(){this.getMessageList()},methods:{toArticle:function(e){window.open("http://zhsdsb.top:8080/#/customer/detail/"+e)},getMessageList:function(){var e=this;return o()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,l.a.message.getList(e.queryCondition);case 3:n=t.sent,console.log(n),e.messageList=n.list.map(function(t,n){return{id:t.id,index:(e.queryCondition.pageNumber-1)*e.queryCondition.pageSize+n+1,userName:t.userName,toUserName:t.toUserName,content:t.content,articleId:t.articleId,type:t.type,status:t.status,common:t.common,title:t.title,createTime:e.$dayjs(t.createTime).format("YYYY-MM-DD HH:mm:ss")}}),e.total=n.total,e.tableLoading=!1,a=document.querySelector(".inner-layout__page"),Object(s.e)(a,0,800);case 10:case"end":return t.stop()}},t,e)}))()},handleEdit:function(e,t){this.editId=t?t.id+"":"",this.editVisible=!0},handleDelete:function(e,t){var n=this,a=[],i=[];t?(a=[t.id],i=[t.name]):(a=this.selectedRows.map(function(e){return e.id}),i=this.selectedRows.map(function(e){return e.name})),0===i.length?this.$message.warning("请选择要删除的用户！"):this.$confirm("确定删除?","提示",{type:"warning"}).then(o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.message.remove({id:a});case 2:n.$message.success("删除成功！"),n.getMessageList();case 4:case"end":return e.stop()}},e,n)}))).catch(function(){})},handleSelectedRows:function(e){this.selectedRows=e},handleSave:function(){this.handleClose(),this.getMessageList()},handleClose:function(){this.editVisible=!1}}},w=(n(853),Object(v.a)(_,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-manager"},[n("div",{staticClass:"user-manager__header"},[n("div",{staticClass:"title"},[n("section-title",{attrs:{name:"消息列表"}})],1),e._v(" "),n("div",{staticClass:"operation"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleEdit}},[e._v("新增系统消息")]),e._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-minus"},on:{click:e.handleDelete}},[e._v("批量删除")]),e._v(" "),n("export-excel",{attrs:{"file-name":"用户数据表",header:["序号","姓名","邮箱","学校","年龄","状态","性别","角色","注册时间","累计消费额(元)"],"filter-filed":["index","name","email","gender","role","createDate","consume"],data:e.messageList}},[e._v("\n        导出表格\n      ")])],1)]),e._v(" "),n("el-form",{attrs:{inline:!0,model:e.queryCondition}},[n("el-form-item",{attrs:{label:"发送人:"}},[n("el-input",{attrs:{placeholder:"请输入发送人昵称",clearable:""},model:{value:e.queryCondition.from,callback:function(t){e.$set(e.queryCondition,"from",t)},expression:"queryCondition.from"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"接收人:"}},[n("el-input",{attrs:{placeholder:"请输入接收人昵称",clearable:""},model:{value:e.queryCondition.to,callback:function(t){e.$set(e.queryCondition,"to",t)},expression:"queryCondition.to"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"消息内容:"}},[n("el-input",{attrs:{placeholder:"请输入消息关键字",clearable:""},model:{value:e.queryCondition.content,callback:function(t){e.$set(e.queryCondition,"content",t)},expression:"queryCondition.content"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"评论:"}},[n("el-input",{attrs:{placeholder:"请输入评论关键字",clearable:""},model:{value:e.queryCondition.common,callback:function(t){e.$set(e.queryCondition,"common",t)},expression:"queryCondition.common"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"文章标题:"}},[n("el-input",{attrs:{placeholder:"请输入文章关键字",clearable:""},model:{value:e.queryCondition.title,callback:function(t){e.$set(e.queryCondition,"title",t)},expression:"queryCondition.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"消息类型:"}},[n("el-select",{attrs:{placeholder:"请选择角色",multiple:"",clearable:""},model:{value:e.queryCondition.types,callback:function(t){e.$set(e.queryCondition,"types",t)},expression:"queryCondition.types"}},e._l(e.tableMng.getTable("message"),function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getMessageList}},[e._v("查询")])],1)],1),e._v(" "),n("div",{staticClass:"user-manager__table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.messageList,border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectedRows}},[n("el-table-column",{attrs:{type:"selection",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"序号",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"userName",label:"发送人",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"toUserName",label:"接收人",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"content",label:"内容",width:"120px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"type",label:"消息类型",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.tableMng.getNameById("message",t.row.type)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.tableMng.getNameById("status",t.row.status)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"title",label:"对应评论",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.articleId?n("el-link",{on:{click:function(n){return e.toArticle(t.row.articleId)}}},[e._v(e._s(t.row.common))]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"title",label:"对应文章",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.articleId?n("el-link",{on:{click:function(n){return e.toArticle(t.row.articleId)}}},[e._v(e._s(t.row.title))]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"发送时间",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),n("pagination",{attrs:{total:e.total,"page-number":e.queryCondition.pageNumber,"page-size":e.queryCondition.pageSize},on:{"update:pageNumber":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:page-number":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:pageSize":function(t){return e.$set(e.queryCondition,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryCondition,"pageSize",t)},pagination:e.getMessageList}}),e._v(" "),n("edit",{attrs:{id:e.editId,visible:e.editVisible},on:{onClose:e.handleClose,onSave:e.handleSave}})],1)},[],!1,null,"279806c4",null).exports);n.d(t,"default",function(){return w})},876:function(e,t,n){"use strict";n.r(t);var a=n(122),r=n.n(a),i=n(182),o=n.n(i),l=n(77),s=n(35),c=n(610),u={props:{id:{type:String,default:""},kind:{type:Object,default:{}},visible:{type:Boolean,default:!1}},watch:{visible:function(e){e&&this.getDetail()}},data:function(){return{params:{},level:"",firstKinds:[],bars:[],userInfo:{name:"",bar:"",level:"",parent:""},formRules:{bar:[{required:!0,message:"请选择图标",trigger:"change"}],parent:[{required:!0,message:"请选择一级分类",trigger:"change"}],name:[{required:!0,message:"请输入内容",trigger:"blur"}]},submitLoading:!1,getDetailLoading:!1}},mounted:function(){this.getDetail()},methods:{getDetail:function(){var e=this;return o()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.kind.getAllBar();case 2:if(n=t.sent,e.bars=n.map(function(e){return e.content}),e.id){t.next=6;break}return t.abrupt("return");case 6:e.getDetailLoading=!0,e.userInfo=e.kind,console.log(e.userInfo),e.getDetailLoading=!1;case 10:case"end":return t.stop()}},t,e)}))()},handleSubmit:function(){var e,t=this;this.$refs.form.validate((e=o()(r.a.mark(function e(n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=19;break}if(1==t.level||2==t.level||t.id){e.next=5;break}return console.log(t.level),t.$message.error("请选择级别"),e.abrupt("return");case 5:return t.submitLoading=!0,a={},t.id&&(a.id=t.id),a.kindName=t.userInfo.name,a.bar=t.userInfo.bar,(t.level=!t.id)&&(a.parentId=t.userInfo.parent),e.next=13,l.a.kind.update(a);case 13:t.submitLoading=!1,t.handleClose(),t.$emit("onSave"),t.$message.success("提交成功"),e.next=20;break;case 19:t.$message.error("请按照正确格式填写");case 20:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleClose:function(){this.userInfo={},this.$emit("onClose")}}},d=(n(855),n(50)),p=Object(d.a)(u,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"user-edit",attrs:{title:e.id?"编辑分类":"新增分类",width:"700px",visible:e.visible}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.getDetailLoading,expression:"getDetailLoading"}],ref:"form",attrs:{model:e.userInfo,rules:e.formRules,"label-width":"70px"}},[n("el-form-item",{attrs:{label:"名称:",prop:"name"}},[n("el-input",{attrs:{placeholder:"请填写名称",clearable:""},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}})],1),e._v(" "),1==e.userInfo.level||1==e.level?n("el-form-item",{attrs:{label:"图标:",prop:"bar"}},[n("el-select",{attrs:{placeholder:"请选择图标"},model:{value:e.userInfo.bar,callback:function(t){e.$set(e.userInfo,"bar",t)},expression:"userInfo.bar"}},e._l(e.bars,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}},[n("i",{class:e})])}),1)],1):e._e(),e._v(" "),e.id?e._e():n("div",[n("el-form-item",{attrs:{label:"级别:",prop:"level"}},[n("el-radio-group",{model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},[n("el-radio",{attrs:{label:"1",value:"1"}},[e._v("一级")]),e._v(" "),n("el-radio",{attrs:{label:"2",value:"2"}},[e._v("二级")])],1)],1),e._v(" "),(e.userInfo.level=e.id)||2==e.level?n("el-form-item",{attrs:{label:"一级:",prop:"parent"}},[n("el-select",{attrs:{placeholder:"请选择对应一级菜单"},model:{value:e.userInfo.parent,callback:function(t){e.$set(e.userInfo,"parent",t)},expression:"userInfo.parent"}},e._l(e.firstKinds,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):e._e()],1)],1),e._v(" "),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("提 交")])],1)],1)},[],!1,null,"a6b10072",null).exports,m={name:"User",components:{SectionTitle:c.a,Edit:p},data:function(){return{secondKinds:[],firstKinds:[],tableFirstLoading:!1,tableSecondLoading:!1,total:0,selectedRows:[],editId:"",editVisible:!1,kind:{}}},created:function(){this.getKinds()},methods:{checkout:function(e){var t=this;this.secondKinds=e.map(function(e,n){return{id:e.id,name:e.kindName,icon:e.bar,createDate:t.$dayjs(e.createTime).format("YYYY-MM-DD HH:mm:ss")}})},getKinds:function(){var e=this;return o()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tableFirstLoading=!0,t.next=3,l.a.kind.getKinds();case 3:n=t.sent,e.firstKinds=n.map(function(t,n){return{id:t.id,name:t.kindName,icon:t.bar,children:t.children,level:1,createDate:e.$dayjs(t.createTime).format("YYYY-MM-DD HH:mm:ss")}}),e.$refs.edit.firstKinds=e.firstKinds,e.tableFirstLoading=!1,a=document.querySelector(".inner-layout__page"),Object(s.e)(a,0,800);case 9:case"end":return t.stop()}},t,e)}))()},handleEdit:function(e,t,n){this.editId=t?t.id+"":"",this.editId&&(this.kind=t),t&&(this.kind.level=n),this.editVisible=!0},handleDelete:function(e,t){var n=this,a=[],i=[];t?(a=[t.id],i=[t.name]):(a=this.selectedRows.map(function(e){return e.id}),i=this.selectedRows.map(function(e){return e.name})),0===i.length?this.$message.warning("请选择要删除的用户！"):this.$confirm("确定删除用户：“"+i.join("，")+"”？","提示",{type:"warning"}).then(o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.kind.remove({id:a});case 2:n.$message.success("删除成功！"),n.secondKinds=[],n.getKinds();case 5:case"end":return e.stop()}},e,n)}))).catch(function(){})},handleSelectedRows:function(e){this.selectedRows=e},handleSave:function(){this.handleClose(),this.getKinds()},handleClose:function(){this.editVisible=!1}}},f=(n(856),Object(d.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-manager"},[n("div",{staticClass:"user-manager__header"},[n("div",{staticClass:"title"},[n("section-title",{attrs:{name:"分类列表"}})],1),e._v(" "),n("div",{staticClass:"operation"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleEdit}},[e._v("新增分类")]),e._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-minus"},on:{click:e.handleDelete}},[e._v("批量删除")])],1)]),e._v(" "),n("div",{staticClass:"table-container"},[n("div",{staticClass:"user-manager__table",staticStyle:{width:"50%"}},[n("h2",[e._v("一级目录")]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableFirstLoading,expression:"tableFirstLoading"}],attrs:{data:e.firstKinds,border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectedRows}},[n("el-table-column",{attrs:{type:"selection",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{label:"图标",width:"40px"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("i",{class:e.row.icon})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"名称",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"createDate",label:"添加时间",width:"180px",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleEdit(t.$index,t.row,1)}}},[e._v("编辑")]),e._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]),e._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.checkout(t.row.children)}}},[e._v("二级")])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"user-manager__table",staticStyle:{width:"50%"}},[n("h2",[e._v("二级目录")]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableSecondLoading,expression:"tableSecondLoading"}],attrs:{data:e.secondKinds,border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectedRows}},[n("el-table-column",{attrs:{type:"selection",width:"70px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"名称",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"createDate",label:"添加时间",width:"180px",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleEdit(t.$index,t.row,2)}}},[e._v("编辑")]),e._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),n("edit",{ref:"edit",attrs:{kind:e.kind,id:e.editId,visible:e.editVisible},on:{onClose:e.handleClose,onSave:e.handleSave}})],1)},[],!1,null,"1749eedc",null).exports);n.d(t,"default",function(){return f})},900:function(e,t,n){"use strict";n.r(t);var a=n(122),r=n.n(a),i=n(182),o=n.n(i),l=n(77),s=n(35),c=n(183),u=n(610),d=n(613),p=n(612),m={name:"topic",components:{SectionTitle:u.a,ExportExcel:d.a,Pagination:p.a},data:function(){return{tableMng:c.a,topicList:[],tableLoading:!1,queryCondition:{from:"",pageNumber:1,pageSize:20,to:"",content:"",title:""},total:0,selectedRows:[],editId:"",editVisible:!1}},created:function(){this.getTopicList()},methods:{toArticle:function(e){window.open("http://zhsdsb.top:8080/#/customer/detail/"+e)},getTopicList:function(){var e=this;return o()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,l.a.topic.getList(e.queryCondition);case 3:n=t.sent,e.topicList=n.list.map(function(t,n){return{id:t.id,index:(e.queryCondition.pageNumber-1)*e.queryCondition.pageSize+n+1,from:t.userName,to:t.toUserName,title:t.title,content:t.content,articleId:t.articleId,createDate:e.$dayjs(t.createTime).format("YYYY-MM-DD HH:mm:ss")}}),e.total=n.total,e.tableLoading=!1,a=document.querySelector(".inner-layout__page"),Object(s.e)(a,0,800);case 9:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e,t){var n=this,a=[],i=[];t?(a=[t.id],i=[t.content]):(a=this.selectedRows.map(function(e){return e.id}),i=this.selectedRows.map(function(e){return e.content})),0===i.length?this.$message.warning("请选择要删除的评论！"):this.$confirm("确定删除内容：“"+i.join("，")+"”？","提示",{type:"warning"}).then(o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.topic.remove({id:a});case 2:n.$message.success("删除成功！"),n.getTopicList();case 4:case"end":return e.stop()}},e,n)}))).catch(function(){})},handleSelectedRows:function(e){this.selectedRows=e},handleClose:function(){this.editVisible=!1}}},f=(n(854),n(50)),b=Object(f.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-manager"},[n("div",{staticClass:"user-manager__header"},[n("div",{staticClass:"title"},[n("section-title",{attrs:{name:"评论列表"}})],1),e._v(" "),n("div",{staticClass:"operation"},[n("el-button",{attrs:{type:"danger",icon:"el-icon-minus"},on:{click:e.handleDelete}},[e._v("批量删除")]),e._v(" "),n("export-excel",{attrs:{"file-name":"评论数据表",header:["序号","发送人","接收人","内容","文章","发送时间"],"filter-filed":["index","from","to","content","title","createDate"],data:e.topicList}},[e._v("\n        导出表格\n      ")])],1)]),e._v(" "),n("el-form",{attrs:{inline:!0,model:e.queryCondition}},[n("el-form-item",{attrs:{label:"发送人:"}},[n("el-input",{attrs:{placeholder:"请输入昵称关键字",clearable:""},model:{value:e.queryCondition.from,callback:function(t){e.$set(e.queryCondition,"from",t)},expression:"queryCondition.from"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"接收人:"}},[n("el-input",{attrs:{placeholder:"请输入学校关键字",clearable:""},model:{value:e.queryCondition.to,callback:function(t){e.$set(e.queryCondition,"to",t)},expression:"queryCondition.to"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"内容:"}},[n("el-input",{attrs:{placeholder:"请输入学校关键字",clearable:""},model:{value:e.queryCondition.content,callback:function(t){e.$set(e.queryCondition,"content",t)},expression:"queryCondition.content"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"文章标题:"}},[n("el-input",{attrs:{placeholder:"请输入学校关键字",clearable:""},model:{value:e.queryCondition.title,callback:function(t){e.$set(e.queryCondition,"title",t)},expression:"queryCondition.title"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getTopicList}},[e._v("查询")])],1)],1),e._v(" "),n("div",{staticClass:"user-manager__table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.topicList,border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectedRows}},[n("el-table-column",{attrs:{type:"selection",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"序号",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"from",label:"发送人",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"to",label:"接收人",width:"80px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"content",label:"内容",width:"180px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"title",label:"文章",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-link",{on:{click:function(n){return e.toArticle(t.row.articleId)}}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"createDate",label:"发表时间",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),n("pagination",{attrs:{total:e.total,"page-number":e.queryCondition.pageNumber,"page-size":e.queryCondition.pageSize},on:{"update:pageNumber":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:page-number":function(t){return e.$set(e.queryCondition,"pageNumber",t)},"update:pageSize":function(t){return e.$set(e.queryCondition,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryCondition,"pageSize",t)},pagination:e.getTopicList}})],1)},[],!1,null,"170541c8",null).exports;n.d(t,"default",function(){return b})}}]);